confint <- function(x) {
  x <- na.omit(x)
  quant <- quantile(x, prob=c(0.025,0.975), names=F)
  mean <- mean(x)
  data.frame(y=mean, ymin=quant[1], ymax=quant[2])
}

pdf('human_contrib.pdf')
ggplot(subset(species_data, groups=="random"), aes(x=N/3540,y=Human))+
  stat_summary(fun.data="confint", geom="smooth", colour="red",
               alpha=0.4)+ theme_bw()+
  scale_x_continuous("Fraction of human population exposed")+
  scale_y_continuous(substitute(R[0]*" in system of humans and vector"))+
  geom_abline(intercept=1,slope=0) 
dev.off()

human_animal_random <- melt(subset(species_data, groups=="random"),
  measure.vars=c("Human", "domestic.wildlife"), id.vars=c("N"),
  variable_name="contrib") 

pdf('human_contrib_animal.pdf')
ggplot(human_animal_random, aes(x=N/3540,y=value, linetype=contrib,
                                 color=contrib))+
  stat_summary(fun.data="confint", geom="smooth", alpha=0.4, lwd=2)+
  theme_bw(20)+
  scale_x_continuous("Fraction of human population exposed")+
  scale_y_continuous(substitute(R[0]*" in system of humans/animals and vector"),
                     limits=c(0,1.4))+
  geom_abline(intercept=1,slope=0,lwd=1.25)+
  opts(legend.position="none", axis.title.x = theme_text(size=20,vjust = -0.5),
       axis.title.y = theme_text(size=20,angle=90, vjust = 0.3))+
  geom_vline(xintercept=0.36061, lwd=1.25, linetype=2)+
  geom_vline(xintercept=0.32455, lwd=1.25, linetype=3)+
  scale_color_brewer(palette="Set1")
dev.off()



pdf('human_contrib_hum_domwild.pdf')
ggplot(subset(species_data, groups=="hum_domwild" & N>3000 &
  habitat=="none"), aes(x=xi,y=Human))+
  stat_summary(fun.data="confint", geom="smooth", colour="red",
               alpha=0.4)+ theme_bw()+
  scale_x_continuous("Rate of host switching between humans and animals", limits=c(0,10))+
  scale_y_continuous(substitute(R[0]*" in system of humans and vector"))+
  geom_abline(intercept=1,slope=0) 
dev.off()

human_animal_hum_domwild <-
  melt(subset(species_data, groups=="hum_domwild" & N>3000 & habitat=="none"),
  measure.vars=c("Human", "domestic.wildlife"), id.vars=c("xi"),
  variable_name="contrib")

pdf('human_contrib_switching_animal.pdf')
ggplot(human_animal_hum_domwild, aes(x=xi,y=value, linetype=contrib,
                                     color=contrib))+ 
  stat_summary(fun.data="confint", geom="smooth", alpha=0.4, lwd=2)+
  theme_bw(20)+
  scale_x_log10("Rate of host switching between humans and animals")+
  scale_y_continuous(substitute(R[0]*" in system of humans/animal and vector"),
                     limits=c(0,1.2))+
  geom_abline(intercept=1,slope=0, lwd=1.25)+
  opts(legend.position="none", axis.title.x = theme_text(size=20,vjust = -0.5),
       axis.title.y = theme_text(size=20,angle=90, vjust = 0.3))+
  scale_color_brewer(palette="Set1")
dev.off()

for (i in 1:(length(values)-1)) {
  cat(values[i], quantile(subset(human_animal_contrib, N==values[i])$value,
                          prob=c(0.5,0.9,0.95,0.99), names=F), "\n")
  cat(values[i], quantile(subset(human_animal_contrib, N==values[i])$value,
                          prob=c(0.5,0.9,0.95,0.99), names=F), "\n")
}

## 175 0.827791 1.129981 1.151711 1.18732 
## 209.394 0.822328 1.088331 1.108086 1.140792 
## 243.788 0.815065 1.060882 1.079272 1.107748 
## 278.182 0.806149 1.034761 1.053783 1.085881 
## 312.576 0.8016165 1.015344 1.035281 1.065666 
## 346.97 0.802253 0.9976549 1.018404 1.057158 
## 381.364 0.795116 0.9854373 1.006481 1.04527 
## 415.758 0.790797 0.9712243 0.9951228 1.035919 
## 450.152 0.78847 0.9625717 0.9848777 1.049185 
## 484.545 0.787199 0.9567621 0.9819597 1.062051 
## 518.939 0.781865 0.9459342 0.9702433 1.034714 
## 553.333 0.7807365 0.937332 0.9658829 1.051872 
## 587.727 0.779978 0.9291369 0.9610902 1.046309 
## 622.121 0.777303 0.9232068 0.9563943 1.043342 
## 656.515 0.7764175 0.9251963 0.9592661 1.077431 
## 690.909 0.7737155 0.9201365 0.9549157 1.071404 
## 725.303 0.774601 0.9167071 0.9547426 1.113023 
## 759.697 0.772302 0.9138165 0.9564634 1.084343 
## 794.091 0.770766 0.9161381 0.9697742 1.121818 
## 828.485 0.769899 0.9157775 0.9704636 1.103364 
## 862.879 0.76803 0.9204023 0.9824133 1.109659 
## 897.273 0.768174 0.9194856 0.9763576 1.126511 
## 931.667 0.76725 0.9189759 0.9844875 1.152316 
## 966.061 0.764919 0.9265145 0.9996116 1.149121 
## 1000.45 0.764663 0.9301706 0.995423 1.138826 
## 1034.85 0.763079 0.9346776 1.003069 1.140268 
## 1069.24 0.763431 0.9390401 1.005222 1.136106 
## 1103.64 0.7623715 0.9355429 1.00533 1.149934 
## 1138.03 0.760741 0.9460664 1.018984 1.158605 
## 1172.42 0.7615085 0.9446622 1.011986 1.154276 
## 1206.82 0.760201 0.948942 1.014028 1.160873 
## 1241.21 0.7596795 0.9592896 1.030945 1.187115 
## 1275.61 0.7593905 0.9588901 1.030305 1.167616 
## 1310 0.7587695 0.9636151 1.033706 1.172517 
## 1344.39 0.7589315 0.9695915 1.037926 1.201366 
## 1378.79 0.7574015 0.9682702 1.041644 1.202007 
## 1413.18 0.7571165 0.9773601 1.04252 1.176629 
## 1447.58 0.756915 0.9738837 1.035446 1.191536 
## 1481.97 0.756457 0.979845 1.044917 1.209264 
## 1516.36 0.754928 0.9865454 1.055084 1.184397 
## 1550.76 0.7557985 0.9891259 1.049808 1.191891 
## 1585.15 0.754996 0.9899596 1.055514 1.187554 
## 1619.55 0.7551035 0.9856606 1.052825 1.210476 
## 1653.94 0.7558605 0.9979805 1.063711 1.220747 
## 1688.33 0.7525995 0.9997303 1.068016 1.22058 
## 1722.73 0.754652 0.9956157 1.069971 1.220607 
## 1757.12 0.752164 1.003628 1.067432 1.21922 
## 1791.52 0.751386 1.005847 1.063036 1.19422 
## 1825.91 0.7526165 1.00812 1.074567 1.233137 
## 1860.3 0.7519235 1.009745 1.077426 1.23816 
## 1894.7 0.753145 1.013301 1.082281 1.233687 
## 1929.09 0.7512575 1.019313 1.083001 1.232281 
## 1963.48 0.7526555 1.01649 1.081416 1.236829 
## 1997.88 0.7504485 1.013767 1.076113 1.249428 
## 2032.27 0.7503875 1.018158 1.080076 1.258304 
## 2066.67 0.7503495 1.022604 1.08152 1.242691 
## 2101.06 0.7492645 1.019491 1.077334 1.21507 
## 2135.45 0.7496505 1.026672 1.083721 1.226472 
## 2169.85 0.7485125 1.026861 1.082524 1.237788 
## 2204.24 0.749946 1.030645 1.09614 1.263413 
## 2238.64 0.748014 1.032216 1.094093 1.255057 
## 2273.03 0.7464735 1.030704 1.089677 1.225304 
## 2307.42 0.7475035 1.032833 1.093228 1.237441 
## 2341.82 0.748206 1.035116 1.095157 1.249711 
## 2376.21 0.746153 1.037215 1.098429 1.241803 
## 2410.61 0.7479175 1.040586 1.099254 1.253544 
## 2445 0.7466655 1.041184 1.095313 1.252506 
## 2479.39 0.7466065 1.038301 1.095638 1.246773 
## 2513.79 0.7455 1.042248 1.102405 1.262221 
## 2548.18 0.7479915 1.041399 1.108067 1.272938 
## 2582.58 0.746877 1.043464 1.112437 1.265254 
## 2616.97 0.7442645 1.047766 1.112744 1.283344 
## 2651.36 0.74599 1.045355 1.108376 1.289454 
## 2685.76 0.745455 1.047786 1.102512 1.245771 
## 2720.15 0.747262 1.048132 1.103696 1.272754 
## 2754.55 0.7465715 1.055577 1.115934 1.279861 
## 2788.94 0.7449285 1.053941 1.117797 1.281457 
## 2823.33 0.744986 1.056744 1.115803 1.305847 
## 2857.73 0.7457975 1.053289 1.110867 1.283516 
## 2892.12 0.7444825 1.053813 1.117982 1.2809 
## 2926.52 0.743686 1.059332 1.11886 1.252348 
## 2960.91 0.7460045 1.059741 1.116596 1.272887 
## 2995.3 0.7413105 1.063591 1.129441 1.292177 
## 3029.7 0.745733 1.057341 1.117451 1.282808 
## 3064.09 0.7483635 1.05975 1.123439 1.29564 
## 3098.48 0.7405255 1.0641 1.124186 1.267109 
## 3132.88 0.746688 1.064028 1.132552 1.301157 
## 3167.27 0.7452905 1.064702 1.124378 1.316591 
## 3201.67 0.7415275 1.063922 1.132921 1.280607 
## 3236.06 0.742245 1.066173 1.125012 1.282684 
## 3270.45 0.7435875 1.063496 1.122428 1.274443 
## 3304.85 0.744661 1.068647 1.131252 1.277211 
## 3339.24 0.744349 1.069266 1.125597 1.299836 
## 3373.64 0.7456245 1.06982 1.127849 1.274116 
## 3408.03 0.7423635 1.0717 1.134293 1.285415 
## 3442.42 0.7448505 1.073228 1.132485 1.284507 
## 3476.82 0.741408 1.075259 1.127884 1.289143 
## 3511.21 0.7417005 1.075275 1.139199 1.323051 
## 3545.61 0.7474095 1.07532 1.141013 1.320745 
